(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(e,t,i){e.exports=i(26)},23:function(e,t,i){},24:function(e,t,i){},26:function(e,t,i){"use strict";i.r(t);var a=i(13),n=i.n(a),r=i(16),o=i.n(r);i(23),i(24);var s=function(){return n.a.createElement("div",{className:"App"})},c=i(0),l=i(1),h=i(6),u=i(3),y=i(2),v=i(4),d=function(){function e(t){Object(c.a)(this,e),this.id=void 0,this.character=void 0,this.color=void 0,this.backgroundColor=void 0,this.priority=void 0,this.collideable=void 0,this.active=void 0,this.id=t.id,this.priority=t.priority,this.character=t.character,this.color=t.color,this.collideable=t.collideable,this.backgroundColor=t.backgroundColor?t.backgroundColor:null,this.active=t.active}return Object(l.a)(e,[{key:"actUponByEnemy",value:function(){}},{key:"actUponByPlayer",value:function(){}},{key:"getBackgroundColor",value:function(){return this.backgroundColor}},{key:"getCharacter",value:function(){return this.character}},{key:"getCollideable",value:function(){return this.collideable}},{key:"getColor",value:function(){return this.color}},{key:"getPriority",value:function(){return this.priority}},{key:"equals",value:function(e){return this.id===e.id}}]),e}(),g=function(e){function t(e){var i;return Object(c.a)(this,t),(i=Object(u.a)(this,Object(y.a)(t).call(this,{active:!0,id:e.id,priority:e.priority,character:e.character,color:e.color,collideable:e.collideable,backgroundColor:e.backgroundColor}))).x=void 0,i.y=void 0,i.game=void 0,i.x=e.x,i.y=e.y,i.game=e.game,i}return Object(v.a)(t,e),Object(l.a)(t,[{key:"act",value:function(){this.game.engine.lock()}},{key:"moveTowardsPlayer",value:function(e){var t=this,i=this.game.player.getX(),a=this.game.player.getY(),n=new h.f.AStar(i,a,function(e,i){return!t.game.map.isSpaceOccupied(e,i)},{topology:e}),r=[];n.compute(this.x,this.y,function(e,t){r.push([e,t])}),r.shift(),r.length>0&&(i=r[0][0],a=r[0][1],this.game.map.moveEntity(this,i,a),this.x=i,this.y=a)}},{key:"interactWithCurrentSpace",value:function(){this.game.map.actUponSpaceByEnemy(this.x,this.y)}},{key:"isInPositionOfPlayer",value:function(){return this.x===this.game.player.getX()&&this.y===this.game.player.getY()}},{key:"removeSelf",value:function(){this.game.removeEntity(this)}},{key:"actUponByPlayer",value:function(){this.removeSelf()}},{key:"actUponByEnemy",value:function(){}},{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"setX",value:function(e){this.x=e}},{key:"setY",value:function(e){this.y=e}}]),t}(d),m=function(){function e(t){Object(c.a)(this,e),this._entities=void 0,this._entities=new Array(t)}return Object(l.a)(e,[{key:"actUponByEnemy",value:function(){this._entities.forEach(function(e){e.actUponByEnemy()})}},{key:"actUponByPlayer",value:function(){this._entities.forEach(function(e){e.actUponByPlayer()})}},{key:"addEntity",value:function(e){this._entities.push(e)}},{key:"doesTileContainEntity",value:function(e){for(var t=0;t<this._entities.length;t++)if(e.equals(this._entities[t]))return!0;return!1}},{key:"getDisplayedTile",value:function(){if(this._entities.length<=0)return null;for(var e=this._entities[0],t=1;t<this._entities.length;t++)this._entities[t].getPriority()>e.getPriority()&&(e=this._entities[t]);return e}},{key:"isCollideable",value:function(){var e=!1;return this._entities.forEach(function(t){t.getCollideable()&&(e=!0)}),e}},{key:"isImmoveable",value:function(){var e=!1;return this._entities.forEach(function(t){!t.getCollideable()||t instanceof g||(e=!0)}),e}},{key:"removeEntity",value:function(e){var t=this._entities.find(function(t){return t.equals(e)});t&&this._entities.splice(this._entities.indexOf(t),1)}}]),e}(),p=15,f=100,O=40,b=20,k="#FFFFFF",R={ID:-1,CHAR:"@",COLOR:"#00FF00",PRIORITY:100,VISION_RADIUS:12},E={CHAR:"b",COLOR:"#0066ff",PRIORITY:41},I={CHAR:"z",COLOR:"#CC00FF",PRIORITY:40},C={CHAR:".",COLOR:"#808080",PRIORITY:-1},w={CHAR:"^",UNLIT_COLOR:"#BFBFBF",LIT_COLOR:"#FF9900",PRIORITY:4,VISION_RADIUS:4},_={ID:-2,CHAR:"<",COLOR:"orange",PRIORITY:10},j={CHAR:"#",COLOR:"#FFFFFF",PRIORITY:0},A={ARENA:"arena",CELLULAR:"cellular",DUNGEON_DIGGER:"digger",DUNGEON_ROGUE:"rogue",DUNGEON_UNIFORM:"uniform",MAZE_DIVIDED:"divided_maze",MAZE_ELLER:"eller_maze",MAZE_ICEY:"icey_maze"},T=999999,U={38:0,56:0,33:1,57:1,39:2,54:2,34:3,51:3,40:4,50:4,35:5,49:5,37:6,52:6,36:7,55:7},F=function(e){function t(){Object(c.a)(this,t);var e=h.g.getUniformInt(0,T);return Object(u.a)(this,Object(y.a)(t).call(this,{id:e,priority:j.PRIORITY,character:j.CHAR,color:j.COLOR,collideable:!0,active:!1}))}return Object(v.a)(t,e),t}(d),D=function(e){function t(){Object(c.a)(this,t);var e=h.g.getUniformInt(0,T);return Object(u.a)(this,Object(y.a)(t).call(this,{id:e,priority:C.PRIORITY,character:C.CHAR,color:C.COLOR,collideable:!1,active:!1}))}return Object(v.a)(t,e),t}(d),P=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(y.a)(t).call(this,{id:_.ID,priority:_.PRIORITY,character:_.CHAR,color:_.COLOR,collideable:!1,active:!1}))}return Object(v.a)(t,e),t}(d),L=function(){function e(){Object(c.a)(this,e),this._map=void 0,this.display=void 0,this._map=this.create2DArrayOfTiles(f,O),this.display=new h.b({width:f,height:O,fontSize:p}),this.generateMap(A.DUNGEON_UNIFORM)}return Object(l.a)(e,[{key:"create2DArrayOfTiles",value:function(e,t){for(var i=new Array(e),a=0;a<e;a++)i[a]=new Array(t);return i}},{key:"drawTile",value:function(e,t){var i=this._map[e][t].getDisplayedTile();i||(i=new D),this.display.draw(e,t,i.getCharacter(),i.getColor(),i.getBackgroundColor())}},{key:"generateMap",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A.ARENA;this.addDisplayToDOM();var i=null;switch(t){case A.ARENA:i=new h.e.Arena(f,O);break;case A.CELLULAR:(i=new h.e.Cellular(f,O,{born:[4,5,6,7,8],survive:[2,3,4,5,6]})).randomize(.25);break;case A.DUNGEON_DIGGER:i=new h.e.Digger(f,O,{corridorLength:[2,5],dugPercentage:.8,roomHeight:[4,8],roomWidth:[4,8]});break;case A.DUNGEON_ROGUE:i=new h.e.Rogue(f,O,{});break;case A.DUNGEON_UNIFORM:i=new h.e.Uniform(f,O,{roomDugPercentage:.5,roomHeight:[4,12],roomWidth:[4,12]});break;case A.MAZE_DIVIDED:i=new h.e.DividedMaze(f,O);break;case A.MAZE_ELLER:i=new h.e.EllerMaze(f,O);break;case A.MAZE_ICEY:i=new h.e.IceyMaze(f,O);break;default:i=new h.e.Arena(f,O)}var a=function(t,i,a){e._map[t][i]=new m(a?new F:new D)};if(i.create(a),t===A.CELLULAR){for(var n=0;n<40;n++)i.create(function(){});i.create(a.bind(this))}}},{key:"getFreeTiles",value:function(){for(var e=new Array,t=0;t<this._map.length;t++)for(var i=0;i<this._map[t].length;i++)this._map[t][i].isCollideable()||e.push(t+","+i);return e}},{key:"clearDisplay",value:function(){this.display.clear()}},{key:"doesSpaceContainStairs",value:function(e,t){return this._map[e][t].doesTileContainEntity(new P)}},{key:"drawFOVFromLocation",value:function(e,t,i){var a=this;new h.d.PreciseShadowcasting(function(e,t){return e>=0&&e<f&&t>=0&&t<O&&!a._map[e][t].isImmoveable()}).compute(e,t,i,function(e,t,i,n){a.drawTile(e,t)})}},{key:"actUponSpaceByEnemy",value:function(e,t){this._map[e][t].actUponByEnemy()}},{key:"actUponSpaceByPlayer",value:function(e,t){this._map[e][t].actUponByPlayer()}},{key:"addDisplayToDOM",value:function(){document.body.appendChild(this.display.getContainer()).className="game-map"}},{key:"isSpaceCollideable",value:function(e,t){return this._map[e][t].isCollideable()}},{key:"isSpaceOccupied",value:function(e,t){return this._map[e][t].isImmoveable()}},{key:"moveEntity",value:function(e,t,i){for(var a=0;a<this._map.length;a++)for(var n=0;n<this._map[a].length;n++)if(this._map[a][n].doesTileContainEntity(e))return this._map[a][n].removeEntity(e),void this._map[t][i].addEntity(e)}},{key:"putActiveEntityInRandomFreeSpace",value:function(e){var t=this.getFreeTiles();if(0===t.length)return!1;var i=h.g.getUniformInt(0,t.length-1),a=t[i].split(",");t.splice(i,1);var n=parseInt(a[0]),r=parseInt(a[1]);return e.setX(n),e.setY(r),this._map[n][r].addEntity(e),!0}},{key:"putEntityInRandomFreeSpace",value:function(e){var t=this.getFreeTiles();if(0===t.length)return!1;var i=h.g.getUniformInt(0,t.length-1),a=t[i].split(",");t.splice(i,1);var n=parseInt(a[0]),r=parseInt(a[1]);return this._map[n][r].addEntity(e),!0}},{key:"removeDisplayFromDOM",value:function(){document.body.removeChild(document.body.getElementsByClassName("game-map")[0])}},{key:"removeEntity",value:function(e){for(var t=0;t<this._map.length;t++)for(var i=0;i<this._map[t].length;i++)this._map[t][i].removeEntity(e)}}]),e}(),S=i(8),x=function(e){function t(e,i,a){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(y.a)(t).call(this,{x:e,y:i,game:a,id:R.ID,priority:R.PRIORITY,character:R.CHAR,color:R.COLOR,collideable:!0}))).handleEvent=function(e){var t=e.keyCode;if(t in U){var i=h.a[8][U[t]],a=n.x+i[0],r=n.y+i[1];n.game.map.isSpaceOccupied(a,r)||(n.game.map.moveEntity(Object(S.a)(n),a,r),n.x=a,n.y=r,n.interactWithCurrentSpace(),n.endPlayerTurn())}},n}return Object(v.a)(t,e),Object(l.a)(t,[{key:"act",value:function(){this.game.engine.lock(),this.game.map.drawFOVFromLocation(this.x,this.y,R.VISION_RADIUS),window.document.addEventListener("keydown",this.handleEvent)}},{key:"endPlayerTurn",value:function(){window.document.removeEventListener("keydown",this.handleEvent),this.game.map.clearDisplay(),this.game.engine.unlock()}},{key:"interactWithCurrentSpace",value:function(){this.game.map.doesSpaceContainStairs(this.x,this.y)&&(this.game.logger.logMessage("You ascend.."),this.game.advanceFloors()),this.game.map.actUponSpaceByPlayer(this.x,this.y)}},{key:"actUponByEnemy",value:function(){this.game.logger.logMessage("You were slain!","#FF0000"),this.removeSelf(),this.game.engine.lock()}},{key:"actUponByPlayer",value:function(){}}]),t}(g),N=i(7),M=function(e){function t(e,i,a){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(y.a)(t).call(this,{x:e,y:i,game:a,id:h.g.getUniformInt(0,T),priority:E.PRIORITY,character:E.CHAR,color:E.COLOR,collideable:!0}))).movingRandomlyTurn=!1,n}return Object(v.a)(t,e),Object(l.a)(t,[{key:"act",value:function(){this.movingRandomlyTurn?this.moveARandomDirection():this.moveTowardsPlayer(8),this.interactWithCurrentSpace(),this.movingRandomlyTurn=!this.movingRandomlyTurn}},{key:"actUponByPlayer",value:function(){this.game.logger.logMessage("You have slain a bat!"),Object(N.a)(Object(y.a)(t.prototype),"actUponByPlayer",this).call(this)}},{key:"moveARandomDirection",value:function(){for(var e=new Array,t=-1;t<=1;t++)for(var i=-1;i<=1;i++)this.game.map.isSpaceCollideable(this.x+t,this.y+i)||e.push([this.x+t,this.y+i]);if(e.length>0){var a=e[h.g.getUniformInt(0,e.length-1)];this.game.map.moveEntity(this,a[0],a[1]),this.x=a[0],this.y=a[1]}}}]),t}(g),B=function(e){function t(e,i,a){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(y.a)(t).call(this,{x:e,y:i,game:a,id:h.g.getUniformInt(0,T),priority:I.PRIORITY,character:I.CHAR,color:I.COLOR,collideable:!0}))).skippingTurn=!1,n}return Object(v.a)(t,e),Object(l.a)(t,[{key:"act",value:function(){this.skippingTurn?Object(N.a)(Object(y.a)(t.prototype),"isInPositionOfPlayer",this).call(this)&&Object(N.a)(Object(y.a)(t.prototype),"removeSelf",this).call(this):Object(N.a)(Object(y.a)(t.prototype),"moveTowardsPlayer",this).call(this,4),this.interactWithCurrentSpace(),this.skippingTurn=!this.skippingTurn}},{key:"actUponByPlayer",value:function(){this.game.logger.logMessage("You have slain a zombie!"),Object(N.a)(Object(y.a)(t.prototype),"actUponByPlayer",this).call(this)}}]),t}(g),Y=function(e){function t(e,i,a){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(y.a)(t).call(this,{x:e,y:i,game:a,id:h.g.getUniformInt(0,T),priority:w.PRIORITY,character:w.CHAR,color:w.UNLIT_COLOR,collideable:!0}))).lit=!1,n}return Object(v.a)(t,e),Object(l.a)(t,[{key:"act",value:function(){this.lit&&this.game.map.drawFOVFromLocation(this.x,this.y,w.VISION_RADIUS)}},{key:"actUponByPlayer",value:function(){this.lit||(this.game.logger.logMessage("You have lit a torch."),this.lit=!0,this.color=w.LIT_COLOR)}},{key:"actUponByEnemy",value:function(){this.lit&&(this.game.logger.logMessage("Another creature has quenched a torch.","#FF0000"),this.lit=!1,this.color=w.UNLIT_COLOR)}}]),t}(g),H=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k;Object(c.a)(this,e),this.color=void 0,this.text=void 0,this.text=t,this.color=i,this.trimTextToMaxCharacters()}return Object(l.a)(e,[{key:"getFormattedText",value:function(){return"%c{"+this.color+"}"+this.text+"%c{}"}},{key:"trimTextToMaxCharacters",value:function(){this.text.length>f&&(this.text=this.text.substring(0,f))}}]),e}(),G=function(){function e(){Object(c.a)(this,e),this.messages=new Array,this.display=void 0,this.display=new h.b({width:f,height:b,fontSize:15}),this.addDisplayToDOM(),this.logMessage("You enter the mansion of Strahd von Zarovich. Good luck.")}return Object(l.a)(e,[{key:"addDisplayToDOM",value:function(){document.body.appendChild(this.display.getContainer()).className="logger"}},{key:"drawMessages",value:function(){this.display.clear();for(var e=0;e<this.messages.length;e++)this.display.drawText(1,e+1,this.messages[e].getFormattedText())}},{key:"logMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k;this.messages.length>=b-2&&this.messages.shift(),this.messages.push(new H(e,t)),this.drawMessages()}}]),e}(),z=function(){function e(){Object(c.a)(this,e),this.logger=void 0,this.floor=void 0,this.engine=void 0,this.entities=void 0,this.player=void 0,this.map=void 0,this.scheduler=new h.h.Simple,this.stairs=void 0,this.floor=0,this.engine=new h.c(this.scheduler),this.entities=new Array,this.player=new x(-1,-1,this),this.logger=new G,this.map=new L,this.advanceFloors(),this.engine.start()}return Object(l.a)(e,[{key:"advanceFloors",value:function(){for(this.floor++,this.player&&this.scheduler.remove(this.player);this.entities.length>0;)this.removeEntity(this.entities[0]);this.map&&this.map.removeDisplayFromDOM(),this.map=new L,this.entities=new Array,this.generatePlayer(this.player),this.generateEnemiesForCurrentFloor();for(var e=0;e<10;e++)this.generateActiveEntity(Y);this.stairs=this.generateEntity(P)}},{key:"removeEntity",value:function(e){this.map.removeEntity(e),this.scheduler.remove(e);var t=this.entities.indexOf(e);this.entities.splice(t,1)}},{key:"generateActiveEntity",value:function(e){var t=new e(-1,-1,this);this.map.putActiveEntityInRandomFreeSpace(t)&&(this.entities.push(t),this.scheduler.add(t,!0))}},{key:"generateEnemiesForCurrentFloor",value:function(){for(var e=0;e<4*this.floor;e++)this.createNewEnemyRandomly()}},{key:"generateEntity",value:function(e){var t=new e;if(this.map.putEntityInRandomFreeSpace(t))return t}},{key:"generatePlayer",value:function(e){this.map.putActiveEntityInRandomFreeSpace(e)&&this.scheduler.add(e,!0)}},{key:"createNewEnemyRandomly",value:function(){switch(h.g.getUniformInt(1,2)){case 1:return this.generateActiveEntity(M);case 2:return this.generateActiveEntity(B);default:return this.generateActiveEntity(M)}}}]),e}();Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));new z;o.a.render(n.a.createElement(s,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[17,1,2]]]);
//# sourceMappingURL=main.72aeb7f7.chunk.js.map