(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(e,t,i){e.exports=i(26)},23:function(e,t,i){},24:function(e,t,i){},26:function(e,t,i){"use strict";i.r(t);var n=i(13),a=i.n(n),r=i(16),o=i.n(r);i(23),i(24);var c=function(){return a.a.createElement("div",{className:"App"})},s=i(0),l=i(1),h=i(6),u=i(4),y=i(2),v=i(3),m=function(){function e(t){Object(s.a)(this,e),this.id=void 0,this.character=void 0,this.color=void 0,this.backgroundColor=void 0,this.priority=void 0,this.collideable=void 0,this.active=void 0,this.id=t.id,this.priority=t.priority,this.character=t.character,this.color=t.color,this.collideable=t.collideable,this.backgroundColor=t.backgroundColor?t.backgroundColor:null,this.active=t.active}return Object(l.a)(e,[{key:"actUponByEnemy",value:function(){}},{key:"actUponByPlayer",value:function(){}},{key:"getBackgroundColor",value:function(){return this.backgroundColor}},{key:"getCharacter",value:function(){return this.character}},{key:"getCollideable",value:function(){return this.collideable}},{key:"getColor",value:function(){return this.color}},{key:"getPriority",value:function(){return this.priority}},{key:"equals",value:function(e){return this.id===e.id}}]),e}(),d=function(e){function t(e){var i;return Object(s.a)(this,t),(i=Object(u.a)(this,Object(y.a)(t).call(this,{active:!0,id:e.id,priority:e.priority,character:e.character,color:e.color,collideable:e.collideable,backgroundColor:e.backgroundColor}))).x=void 0,i.y=void 0,i.game=void 0,i.x=e.x,i.y=e.y,i.game=e.game,i}return Object(v.a)(t,e),Object(l.a)(t,[{key:"act",value:function(){this.game.engine.lock()}},{key:"moveTowardsPlayer",value:function(e){var t=this,i=this.game.player.getX(),n=this.game.player.getY(),a=new h.f.AStar(i,n,function(e,i){return!t.game.map.isSpaceOccupied(e,i)},{topology:e}),r=[];a.compute(this.x,this.y,function(e,t){r.push([e,t])}),r.shift(),0==r.length||(1==r.length?(alert("Game over - you were captured!"),this.game.engine.lock()):(i=r[0][0],n=r[0][1],this.game.map.moveEntity(this,i,n),this.x=i,this.y=n))}},{key:"interactWithCurrentSpace",value:function(){this.game.map.actUponSpaceByEnemy(this.x,this.y)}},{key:"isInPositionOfPlayer",value:function(){return this.x===this.game.player.getX()&&this.y===this.game.player.getY()}},{key:"removeSelf",value:function(){this.game.removeEntity(this)}},{key:"actUponByPlayer",value:function(){this.removeSelf()}},{key:"actUponByEnemy",value:function(){}},{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"setX",value:function(e){this.x=e}},{key:"setY",value:function(e){this.y=e}}]),t}(m),p=function(){function e(t){Object(s.a)(this,e),this._entities=void 0,this._entities=new Array(t)}return Object(l.a)(e,[{key:"actUponByEnemy",value:function(){this._entities.forEach(function(e){e.actUponByEnemy()})}},{key:"actUponByPlayer",value:function(){this._entities.forEach(function(e){e.actUponByPlayer()})}},{key:"addEntity",value:function(e){this._entities.push(e)}},{key:"doesTileContainEntity",value:function(e){for(var t=0;t<this._entities.length;t++)if(e.equals(this._entities[t]))return!0;return!1}},{key:"getDisplayedTile",value:function(){if(this._entities.length<=0)return null;for(var e=this._entities[0],t=1;t<this._entities.length;t++)this._entities[t].getPriority()>e.getPriority()&&(e=this._entities[t]);return e}},{key:"isCollideable",value:function(){var e=!1;return this._entities.forEach(function(t){t.getCollideable()&&(e=!0)}),e}},{key:"isImmoveable",value:function(){var e=!1;return this._entities.forEach(function(t){!t.getCollideable()||t instanceof d||(e=!0)}),e}},{key:"removeEntity",value:function(e){var t=this._entities.find(function(t){return t.equals(e)});t&&this._entities.splice(this._entities.indexOf(t),1)}}]),e}(),f=100,g=40,O={ID:-1,CHAR:"@",COLOR:"#00FF00",PRIORITY:100,VISION_RADIUS:12},b={CHAR:"b",COLOR:"blue",PRIORITY:41},k={CHAR:"z",COLOR:"#CC00FF",PRIORITY:40},R={CHAR:".",COLOR:"#808080",PRIORITY:-1},E={CHAR:"^",UNLIT_COLOR:"#BFBFBF",LIT_COLOR:"#FF9900",PRIORITY:4,VISION_RADIUS:4},I={ID:-2,CHAR:"<",COLOR:"orange",PRIORITY:10},C={CHAR:"#",COLOR:"#FFFFFF",PRIORITY:0},w={ARENA:"arena",CELLULAR:"cellular",DUNGEON_DIGGER:"digger",DUNGEON_ROGUE:"rogue",DUNGEON_UNIFORM:"uniform",MAZE_DIVIDED:"divided_maze",MAZE_ELLER:"eller_maze",MAZE_ICEY:"icey_maze"},_=999999,A={38:0,56:0,33:1,57:1,39:2,54:2,34:3,51:3,40:4,50:4,35:5,49:5,37:6,52:6,36:7,55:7},j=function(e){function t(){Object(s.a)(this,t);var e=h.g.getUniformInt(0,_);return Object(u.a)(this,Object(y.a)(t).call(this,{id:e,priority:C.PRIORITY,character:C.CHAR,color:C.COLOR,collideable:!0,active:!1}))}return Object(v.a)(t,e),t}(m),U=function(e){function t(){Object(s.a)(this,t);var e=h.g.getUniformInt(0,_);return Object(u.a)(this,Object(y.a)(t).call(this,{id:e,priority:R.PRIORITY,character:R.CHAR,color:R.COLOR,collideable:!1,active:!1}))}return Object(v.a)(t,e),t}(m),T=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(y.a)(t).call(this,{id:I.ID,priority:I.PRIORITY,character:I.CHAR,color:I.COLOR,collideable:!1,active:!1}))}return Object(v.a)(t,e),t}(m),F=function(){function e(t,i){Object(s.a)(this,e),this._map=void 0,this.display=void 0,this._map=this.create2DArrayOfTiles(t,i),this.display=new h.b({width:t,height:i,fontSize:15}),this.generateMap(w.DUNGEON_UNIFORM)}return Object(l.a)(e,[{key:"create2DArrayOfTiles",value:function(e,t){for(var i=new Array(e),n=0;n<e;n++)i[n]=new Array(t);return i}},{key:"drawTile",value:function(e,t){var i=this._map[e][t].getDisplayedTile();i||(i=new U),this.display.draw(e,t,i.getCharacter(),i.getColor(),i.getBackgroundColor())}},{key:"generateMap",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w.ARENA;document.body.appendChild(this.display.getContainer());var i=null;switch(t){case w.ARENA:i=new h.e.Arena(f,g);break;case w.CELLULAR:(i=new h.e.Cellular(f,g,{born:[4,5,6,7,8],survive:[2,3,4,5,6]})).randomize(.25);break;case w.DUNGEON_DIGGER:i=new h.e.Digger(f,g,{corridorLength:[2,5],dugPercentage:.8,roomHeight:[4,8],roomWidth:[4,8]});break;case w.DUNGEON_ROGUE:i=new h.e.Rogue(f,g,{});break;case w.DUNGEON_UNIFORM:i=new h.e.Uniform(f,g,{roomDugPercentage:.5,roomHeight:[4,12],roomWidth:[4,12]});break;case w.MAZE_DIVIDED:i=new h.e.DividedMaze(f,g);break;case w.MAZE_ELLER:i=new h.e.EllerMaze(f,g);break;case w.MAZE_ICEY:i=new h.e.IceyMaze(f,g);break;default:i=new h.e.Arena(f,g)}var n=function(t,i,n){e._map[t][i]=new p(n?new j:new U)};if(i.create(n),t===w.CELLULAR){for(var a=0;a<40;a++)i.create(function(){});i.create(n.bind(this))}}},{key:"getFreeTiles",value:function(){for(var e=new Array,t=0;t<this._map.length;t++)for(var i=0;i<this._map[t].length;i++)this._map[t][i].isCollideable()||e.push(t+","+i);return e}},{key:"clearDisplay",value:function(){this.display.clear()}},{key:"doesSpaceContainStairs",value:function(e,t){return this._map[e][t].doesTileContainEntity(new T)}},{key:"drawFOVFromLocation",value:function(e,t,i){var n=this;new h.d.PreciseShadowcasting(function(e,t){return e>=0&&e<f&&t>=0&&t<g&&!n._map[e][t].isImmoveable()}).compute(e,t,i,function(e,t,i,a){n.drawTile(e,t)})}},{key:"actUponSpaceByEnemy",value:function(e,t){this._map[e][t].actUponByEnemy()}},{key:"actUponSpaceByPlayer",value:function(e,t){this._map[e][t].actUponByPlayer()}},{key:"isSpaceCollideable",value:function(e,t){return this._map[e][t].isCollideable()}},{key:"isSpaceOccupied",value:function(e,t){return this._map[e][t].isImmoveable()}},{key:"moveEntity",value:function(e,t,i){for(var n=0;n<this._map.length;n++)for(var a=0;a<this._map[n].length;a++)if(this._map[n][a].doesTileContainEntity(e))return this._map[n][a].removeEntity(e),void this._map[t][i].addEntity(e)}},{key:"putActiveEntityInRandomFreeSpace",value:function(e){var t=this.getFreeTiles();if(0===t.length)return!1;var i=h.g.getUniformInt(0,t.length-1),n=t[i].split(",");t.splice(i,1);var a=parseInt(n[0]),r=parseInt(n[1]);return e.setX(a),e.setY(r),this._map[a][r].addEntity(e),!0}},{key:"putEntityInRandomFreeSpace",value:function(e){var t=this.getFreeTiles();if(0===t.length)return!1;var i=h.g.getUniformInt(0,t.length-1),n=t[i].split(",");t.splice(i,1);var a=parseInt(n[0]),r=parseInt(n[1]);return this._map[a][r].addEntity(e),!0}},{key:"removeDisplayFromDOM",value:function(){document.body.removeChild(document.body.getElementsByTagName("canvas")[0])}},{key:"removeEntity",value:function(e){for(var t=0;t<this._map.length;t++)for(var i=0;i<this._map[t].length;i++)this._map[t][i].removeEntity(e)}}]),e}(),L=i(8),P=function(e){function t(e,i,n){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(y.a)(t).call(this,{x:e,y:i,game:n,id:O.ID,priority:O.PRIORITY,character:O.CHAR,color:O.COLOR,collideable:!0}))).handleEvent=function(e){var t=e.keyCode;if(t in A){var i=h.a[8][A[t]],n=a.x+i[0],r=a.y+i[1];a.game.map.isSpaceOccupied(n,r)||(a.game.map.moveEntity(Object(L.a)(a),n,r),a.x=n,a.y=r,a.interactWithCurrentSpace(),a.endPlayerTurn())}},a}return Object(v.a)(t,e),Object(l.a)(t,[{key:"act",value:function(){this.game.engine.lock(),this.game.map.drawFOVFromLocation(this.x,this.y,O.VISION_RADIUS),window.document.addEventListener("keydown",this.handleEvent)}},{key:"endPlayerTurn",value:function(){window.document.removeEventListener("keydown",this.handleEvent),this.game.map.clearDisplay(),this.game.engine.unlock()}},{key:"interactWithCurrentSpace",value:function(){this.game.map.doesSpaceContainStairs(this.x,this.y)&&this.game.advanceFloors(),this.game.map.actUponSpaceByPlayer(this.x,this.y)}},{key:"actUponByEnemy",value:function(){this.removeSelf()}},{key:"actUponByPlayer",value:function(){}}]),t}(d),S=function(e){function t(e,i,n){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(y.a)(t).call(this,{x:e,y:i,game:n,id:h.g.getUniformInt(0,_),priority:b.PRIORITY,character:b.CHAR,color:b.COLOR,collideable:!0}))).movingRandomlyTurn=!1,a}return Object(v.a)(t,e),Object(l.a)(t,[{key:"act",value:function(){this.movingRandomlyTurn?this.moveARandomDirection():this.moveTowardsPlayer(8),this.interactWithCurrentSpace(),this.movingRandomlyTurn=!this.movingRandomlyTurn}},{key:"moveARandomDirection",value:function(){for(var e=new Array,t=-1;t<=1;t++)for(var i=-1;i<=1;i++)this.game.map.isSpaceCollideable(this.x+t,this.y+i)||e.push([this.x+t,this.y+i]);if(e.length>0){var n=e[h.g.getUniformInt(0,e.length-1)];this.game.map.moveEntity(this,n[0],n[1]),this.x=n[0],this.y=n[1]}}}]),t}(d),D=i(7),N=function(e){function t(e,i,n){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(y.a)(t).call(this,{x:e,y:i,game:n,id:h.g.getUniformInt(0,_),priority:k.PRIORITY,character:k.CHAR,color:k.COLOR,collideable:!0}))).skippingTurn=!1,a}return Object(v.a)(t,e),Object(l.a)(t,[{key:"act",value:function(){this.skippingTurn?Object(D.a)(Object(y.a)(t.prototype),"isInPositionOfPlayer",this).call(this)&&Object(D.a)(Object(y.a)(t.prototype),"removeSelf",this).call(this):Object(D.a)(Object(y.a)(t.prototype),"moveTowardsPlayer",this).call(this,4),this.interactWithCurrentSpace(),this.skippingTurn=!this.skippingTurn}}]),t}(d),B=function(e){function t(e,i,n){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(y.a)(t).call(this,{x:e,y:i,game:n,id:h.g.getUniformInt(0,_),priority:E.PRIORITY,character:E.CHAR,color:E.UNLIT_COLOR,collideable:!0}))).lit=!1,a}return Object(v.a)(t,e),Object(l.a)(t,[{key:"act",value:function(){this.lit&&this.game.map.drawFOVFromLocation(this.x,this.y,E.VISION_RADIUS)}},{key:"actUponByPlayer",value:function(){this.lit=!0,this.color=E.LIT_COLOR}},{key:"actUponByEnemy",value:function(){this.lit=!1,this.color=E.UNLIT_COLOR}}]),t}(d),x=function(){function e(){Object(s.a)(this,e),this.floor=void 0,this.engine=void 0,this.entities=void 0,this.player=void 0,this.map=void 0,this.scheduler=new h.h.Simple,this.stairs=void 0,this.floor=0,this.engine=new h.c(this.scheduler),this.entities=new Array,this.player=new P(-1,-1,this),this.map=new F(f,g),this.advanceFloors(),this.engine.start()}return Object(l.a)(e,[{key:"advanceFloors",value:function(){for(this.floor++,this.player&&this.scheduler.remove(this.player);this.entities.length>0;)this.removeEntity(this.entities[0]);this.map&&this.map.removeDisplayFromDOM(),this.map=new F(f,g),this.entities=new Array,this.generatePlayer(this.player),this.generateEnemiesForCurrentFloor();for(var e=0;e<10;e++)this.generateActiveEntity(B);this.stairs=this.generateEntity(T)}},{key:"removeEntity",value:function(e){this.map.removeEntity(e),this.scheduler.remove(e);var t=this.entities.indexOf(e);this.entities.splice(t,1)}},{key:"generateActiveEntity",value:function(e){var t=new e(-1,-1,this);this.map.putActiveEntityInRandomFreeSpace(t)&&(this.entities.push(t),this.scheduler.add(t,!0))}},{key:"generateEnemiesForCurrentFloor",value:function(){for(var e=0;e<4*this.floor;e++)this.createNewEnemyRandomly()}},{key:"generateEntity",value:function(e){var t=new e;if(this.map.putEntityInRandomFreeSpace(t))return t}},{key:"generatePlayer",value:function(e){this.map.putActiveEntityInRandomFreeSpace(e)&&this.scheduler.add(e,!0)}},{key:"createNewEnemyRandomly",value:function(){switch(h.g.getUniformInt(1,2)){case 1:return this.generateActiveEntity(S);case 2:return this.generateActiveEntity(N);default:return this.generateActiveEntity(S)}}}]),e}();Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));new x;o.a.render(a.a.createElement(c,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[17,1,2]]]);
//# sourceMappingURL=main.4eaaeb41.chunk.js.map